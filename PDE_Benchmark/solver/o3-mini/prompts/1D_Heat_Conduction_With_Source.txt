#!/usr/bin/env python3
import numpy as np

# Problem parameters
L = 0.5                  # Length of the rod (m)
k = 1000.0               # Thermal conductivity (W/(m*K))
Q = 2e6                  # Uniform heat generation (W/m^3)
T_left = 100.0           # Dirichlet BC at x=0 (°C)
T_right = 200.0          # Dirichlet BC at x=L (°C)

# Discretization
N = 51                   # Number of grid points
x = np.linspace(0, L, N)
dx = x[1] - x[0]

# Set up the linear system A*T = b for interior nodes
A = np.zeros((N, N))
b = np.zeros(N)

# Apply Dirichlet BCs at boundaries
A[0, 0] = 1.0
b[0] = T_left
A[-1, -1] = 1.0
b[-1] = T_right

# Fill the finite volume discretization for interior nodes
# Using central differences: k*(T[i+1]-2*T[i]+T[i-1])/(dx**2) = -Q
for i in range(1, N-1):
    A[i, i-1] = k / dx**2
    A[i, i]   = -2 * k / dx**2
    A[i, i+1] = k / dx**2
    b[i] = -Q

# Solve the linear system
T = np.linalg.solve(A, b)

# Save the final solution in a 1D numpy array
np.save("T.npy", T)